# Synthetic Terrain Elevation Test

Контролируемый тест высот местности без загрузки OSM данных.

## Описание

Создаёт синтетическую сцену с 5 тестовыми точками на разных высотах:
- **Flat ground** (0m) - плоская поверхность на уровне моря
- **Low hill** (5m) - низкий холм
- **High hill** (10m) - высокий холм
- **Valley** (-3m) - впадина ниже уровня моря
- **Plateau** (7m) - плато

На каждой точке создаётся:
- Платформа на нужной высоте
- Тестовая дорога (MeshInstance3D с именем "Road")
- Тестовое здание (StaticBody3D с именем "Building")

## Что проверяет

1. **Raycast высоты** - измеряет высоту земли с помощью raycast
2. **Размещение дорог** - проверяет что дороги на правильной высоте
3. **Размещение зданий** - проверяет что здания на правильной высоте
4. **Физика машины** - машина падает на платформу и остаётся на ней

## Запуск

```bash
# Headless режим (быстро)
./tests/run_synthetic_test.sh

# С визуализацией
./tests/run_synthetic_test.sh --visual
```

## Результаты

### Успешный тест
```
[PASS] All terrain height tests passed!
Total points tested: 5
Passed: 5
Failed: 0
```

Каждая точка показывает:
```
[TEST] Testing: Low hill (expected height: 5.00m)
  ✓ PASS: measured=5.00m, error=0.005m, car_y=5.49m
  Road height: 5.00m (expected: 5.00m, error: 0.000m)
  Building base: 5.00m (expected: 5.00m, error: 0.000m)
```

### Провальный тест
```
[FAIL] 2 terrain height tests failed

Failed points:
  - Low hill: expected=5.00m, measured=3.50m, error=1.500m
  - Valley: expected=-3.00m, measured=0.00m, error=3.000m
```

## Допуски

- Высота земли (raycast): **0.1м** (10см)
- Высота дорог: точность проверяется вручную
- Высота зданий: точность проверяется вручную

## Преимущества

- ✓ Без интернета - не требует загрузки OSM данных
- ✓ Быстрый - выполняется за ~10 секунд
- ✓ Детерминированный - всегда одинаковые результаты
- ✓ Контролируемый - известные ожидаемые значения
- ✓ Покрывает разные высоты - положительные, отрицательные, нулевые

## Использование

Этот тест полезен для:
1. Проверки работы системы высот без зависимости от внешних данных
2. Быстрой проверки после изменений в коде высот
3. CI/CD - можно запускать автоматически
4. Отладки - легко изменить высоты и проверить конкретные случаи

## Модификация

Чтобы добавить новые тестовые точки, отредактируйте массив `_test_points` в [test_synthetic_terrain.gd](test_synthetic_terrain.gd):

```gdscript
var _test_points := [
	{"name": "My test", "position": Vector3(50, 15, 0), "expected_height": 15.0},
]
```
